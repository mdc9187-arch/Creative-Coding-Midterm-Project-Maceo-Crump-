// • Graphics (shape, color, line, placement, custom shapes)
// • Control Structures (if, for, while)
// • Movement
// • Interaction (mouse, keyboard)
// • Custom functions with passing parameters
// • Arrays
// • Math
// • Random
// • Functions

// Must haves:

// • heavy use of variables
// • custom functions passing variables as parameter
// • Loops
// • control structures
// • math or random
// • some use of interaction or change over time
// • movement, change, variety
// • arrays
// • conditionals
// • OOP - with methods + passing parameters


//NOTES ::: Sketch should have extreme randomness and speed, jarring activity, but with a press of space or a mouse click, should revert from chaos to absolute order, a still frame of something beautiful.


//CLICK or keypress could toggle between clock display and chaos

//******Time should show at beginning, change to next scene, and then show again in intervals?

//Make Increases/changes in stroke weight after time change, alternate back and forth

///NEW time intro scene


// Scene 1 = Clock, Scene 2 = Chaos
let currentScene = 1;


const numLoops = 1000;

let LoopsX = [];

let LoopsY = [];

let LoopsSize = [];

let LoopsSpeed = [];

let LoopsAreMoving = true;


function setup() {
  createCanvas(500, 500);

  for (let i = 0; i < numLoops; i++) {
    LoopsX[i] = random(width);
    LoopsY[i] = random(height);
    LoopsSize[i] = random(1, 1000);
    LoopsSpeed[i] = random(0.5, 200);

  }
}

function draw() {

  if (currentScene == 1) {
    drawClock();
  } 

  else if (currentScene == 2) {
    drawChaos();
  }
}

//   SCENE 1: CLOCK
function drawClock() {
  background(0);
  fill(255);
  noStroke();
  textSize(15);
  textAlign(CENTER, CENTER);

  // current time
  let h = hour();
  let m = minute();
  let s = second();

  let suffix = "AM"; // AM is default
  
  if (h == 0) {
    // midnight
    h = 12;
  } 
  else if (h == 12) {
    // noon
    suffix = "PM";
  } 
  else if (h > 12) {
    // PM (1PM to 11PM)
    h = h - 12; // convert 13-23 to 1-11
    suffix = "PM";
  }
  
  // two digits
  let timeString = nf(h, 2) + ":" + nf(m, 2) + ":" + nf(s, 2) + " " + suffix;

  text(timeString, width / 2, height / 2);

}


//   SCENE 2: CHAOS

  
function drawChaos() {
  // after 5 secs 
  if (millis() < 5000) {
    drawVoid(); // black background first5 secos
  } else {
    // randomize color for background after
    background(random(255), random(255), random(255));
  }

  handleLoops(); // draw ellipses
}

function drawVoid() {
  let topColor = color(0);
  let bottomColor = color(0);
  for (let i = 0; i < height; i++) {
    let inter = map(i, 0, height, 0, 1);
    let c = lerpColor(topColor, bottomColor, inter);
    stroke(c);
    line(0, i, width, i);
  }
}

function handleLoops() {
  for (let i = 0; i < numLoops; i++) {
    // only move if true
    if (LoopsAreMoving) {
      LoopsY[i] -= LoopsSpeed[i];
    }

    // reset when reaches top
    if (LoopsY[i] < -LoopsSize[i]) {
      LoopsY[i] = height + LoopsSize[i];
      LoopsX[i] = random(width);
    }

    // Loop styles
    stroke(255, 170); // transparent white
    strokeWeight(1);
    noFill();
    ellipse(2 * LoopsX[i], LoopsY[i], LoopsSize[i], LoopsSize[i]);
  }
}




function mousePressed() {

  // freeze scene 2

  LoopsAreMoving = !LoopsAreMoving;

}



function keyPressed() {

  // switch scene

  if (currentScene == 1) {
    currentScene = 2;
  } else {
    currentScene = 1;
  }
}

